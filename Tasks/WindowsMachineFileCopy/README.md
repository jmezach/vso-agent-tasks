# Windows Machine File Copy Task
### Overview
The task is used to copy application files and other artifacts that are required to install the application on Windows Machines like PowerShell scripts, PowerShell-DSC modules etc. The task provides the ability to copy files to Windows Machines. The tasks uses RoboCopy, the command-line utility built for fast copying of data.

###The different parameters of the task are explained below:

*	**Source**: The source of the files. As described above using pre-defined system variables like $(Build.Repository.LocalPath) make it easy to specify the location of the build on the Build Automation Agent machine. The variables resolve to the working folder on the agent machine, when the task is run on it. Wild cards like **\*.zip are not supported.
*	**Machine Group**: Name of the resource group that contains the Windows Machines.
*	**Select Machines By**: The parameter is used to copy the files to a subset of Machines and the subset can be specified by the names of the machines or the tags on them.  
*	**Filter Criteria**: If copying to a subset of machines provide a comma separated list of the machines here, else if using tags then provide the tags in the format Role:Web; OS:win7. The default is to copy to all the machines in the Machine Group.
*	**Destination Folder**: The folder in the Windows machines where the files will be copied to. Environment variables are also supported like $env:windir, $env:systemroot etc. An example of the destination folder is $env:windir\FabrikamFibre\Web.
*	**Clean Target**: Checking this option will clean the destination folder prior to copying the files to it.
*	**Copy Files in Parallel**: Checking this option will copy files to all the machines in the Machine Group in-parallel, hence speeding up the process of copying.

### Machine Pre-requisites for the Task :

| S.NO | Target Machine State                                       | Target Machine trust with Automation agent | Machine Identity | Authentication Account                    | Authentication Mode | Authentication Account permission on Target Machine | Connection Type | Pre-requisites in Target machine for Copy Task to succeed                                                                                                                                                                                                                                                                                                                                                                                                                    |
|------|------------------------------------------------------------|--------------------------------------------|------------------|-------------------------------------------|---------------------|-----------------------------------------------------|-----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1    | Domain joined machine in Corp network                      | Trusted                                    | DNS name         | Domain account                            | Kerberos            | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port,(default 5985) opened in Firewall.</li><li>File & Printer sharing enabled.</li></ul>                                                                                                                                                                                                                                                                                                                                                                 |
| 2    | Domain joined machine in Corp network                      | Trusted                                    | DNS name         | Domain account                            | Kerberos            | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then Test Certificate option enabled in Task for deployment.</li><li>File & Printer sharing enabled.</li></ul>                                                                                                                                                                                          |
| 3    | Domain joined machine,or Workgroup machine in Corp network | Any                                        | DNS name         | Local machine account                     | NTLM                | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions <a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent <a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li><li>File & Printer sharing enabled</li></ul>    |
| 4    | Domain joined machine or Workgroup machine,in Corp network | Any                                        | DNS name         | Local machine account                     | NTLM                | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then Test Certificate option enabled in Task for deployment.</li><li>File & Printer sharing enabled.</li></ul>                          |
| 5    | Any                                                        | Any                                        | IP address       | Any                                       | NTLM                | Machine Administrator                               | WinRM HTTP      | <ul><li>WinRM HTTP port (default 5985) opened in Firewall.</li><li>Disable UAC remote restrictions <a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format</li><li>Set "AllowUnencrypted" option and add remote machines in "Trusted Host" list in Automation Agent <a href="https://msdn.microsoft.com/en-us/library/aa384372(v=vs.85).aspx">(link)</a></li><li>File & Printer sharing enabled</li></ul>    |
| 6    | Any                                                        | Any                                        | IP address       | Any                                       | NTLM                | Machine Administrator                               | WinRM HTTPS     | <ul><li>WinRM HTTPS port  (default 5986) opened in Firewall.</li><li>Disable UAC remote restrictions<a href="https://support.microsoft.com/en-us/kb/951016">(link)</a></li><li>Credential in <MachineName>\<Account> format.</li><li>Trusted certificate in Automation agent.</li><li>If Trusted certificate not in Automation agent then Test Certificate option enabled in Task for deployment.</li><li>File & Printer sharing enabled.</li></ul>                          |
